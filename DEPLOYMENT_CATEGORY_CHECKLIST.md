# ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ: ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ»ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªãƒ¼ç®¡ç†

## âš ï¸ é‡è¦ãªé–‹ç™ºåŸå‰‡

### ğŸš« çµ¶å¯¾ã«ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨
1. **ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã®ã”ã¾ã‹ã—**: ã€Œãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€ã¨ã„ã†åç›®ã§ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã‚’æ®‹ã™ã“ã¨
2. **ä¸å®Œå…¨ãªã‚­ãƒ£ãƒƒã‚·ãƒ¥åŒ–**: DBèª­ã¿è¾¼ã¿ã‚’ã›ãšã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã ã‘ã§æ¸ˆã¾ã›ã‚‹ã“ã¨
3. **æ‰‹å‹•æ›´æ–°ã®æ”¾ç½®**: DBå¤‰æ›´æ™‚ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã®æ›´æ–°ã‚’å¿˜ã‚Œã‚‹ã“ã¨

### âœ… æ­£ã—ã„å®Ÿè£…æ–¹é‡
1. **DBå„ªå…ˆ**: å¸¸ã«DBã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
2. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: DBéšœå®³æ™‚ã®ã¿ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ä½¿ç”¨
3. **è‡ªå‹•åŒæœŸ**: ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã«DBâ†’ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰è‡ªå‹•æ›´æ–°

## ğŸ“‹ ãƒ‡ãƒ—ãƒ­ã‚¤å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Phase 1: DBå¤‰æ›´ãƒã‚§ãƒƒã‚¯
```bash
# 1. æœ€æ–°ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ»ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ç”Ÿæˆ
npm run generate:category-mapping

# 2. å·®åˆ†ç¢ºèªï¼ˆå‡ºåŠ›ã‚’ç¢ºèªï¼‰
# - "æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã¨ä¸€è‡´ã—ã¦ã„ã¾ã™" â†’ å¤‰æ›´ãªã—ã€ãã®ã¾ã¾é€²è¡Œ
# - "å·®åˆ†ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ" â†’ Phase 2ã¸é€²ã‚€
```

### Phase 2: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰æ›´æ–°ï¼ˆå·®åˆ†ãŒã‚ã‚‹å ´åˆã®ã¿ï¼‰
```bash
# 1. ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã§æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°
cp lib/category-mapping-generated.ts lib/category-mapping.ts

# 2. TypeScript ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯
npx tsc --noEmit

# 3. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run test:category-cache

# 4. Git ã‚³ãƒŸãƒƒãƒˆ
git add lib/category-mapping.ts
git commit -m "Update category mapping from database

ğŸ¤– Auto-generated from database on $(date)
- Categories: XXä»¶ (Main: XX, Industry: XX)  
- Subcategories: XXä»¶

ğŸ”§ Generated with [Claude Code](https://claude.ai/code)"
```

### Phase 3: ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ
```bash
# é€šå¸¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ã‚’å®Ÿè¡Œ
npm run build
npm run deploy
```

## ğŸ”§ package.json ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¿½åŠ 

ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ `package.json` ã«è¿½åŠ ã—ã¦ãã ã•ã„ï¼š

```json
{
  "scripts": {
    "generate:category-mapping": "npx tsx scripts/generate-category-mapping.ts",
    "test:category-cache": "npx tsx scripts/test-simple-cache.ts",
    "pre-deploy:check": "npm run generate:category-mapping && npx tsc --noEmit"
  }
}
```

## ğŸ¯ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œç¢ºèª

### æ­£å¸¸å‹•ä½œãƒ‘ã‚¿ãƒ¼ãƒ³
1. **åˆå›ã‚¢ã‚¯ã‚»ã‚¹**: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆæœ€æ–°ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ï¼‰ã§å³åº§è¡¨ç¤º
2. **3ç§’å¾Œ**: DBã‹ã‚‰èª­ã¿è¾¼ã¿å®Œäº†ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°
3. **2å›ç›®ä»¥é™**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ç¬æ™‚å–å¾—ï¼ˆ0msï¼‰

### ç•°å¸¸å‹•ä½œã®æ¤œå‡ºæ–¹æ³•
```typescript
// ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèª
import { getCacheStats } from '@/lib/category-cache-simple'
console.log(getCacheStats())

// æ­£å¸¸: { categoriesLoaded: true, categoriesCount: 24, subcategoriesLoaded: true, subcategoriesCount: 145 }
// ç•°å¸¸: categoriesCount ãŒ 0 ã‚„æ¥µç«¯ã«å°‘ãªã„å€¤
```

## ğŸ“Š é‹ç”¨ç›£è¦–æŒ‡æ¨™

### DBæ­£å¸¸æ™‚
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥èª­ã¿è¾¼ã¿æ™‚é–“: < 500ms
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä»¶æ•°: Categories 24ä»¶, Subcategories 145ä»¶ç¨‹åº¦

### DBéšœå®³æ™‚
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç™ºå‹•: `console.warn` ã§ãƒ­ã‚°å‡ºåŠ›
- è¡¨ç¤ºç¶™ç¶š: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«ã‚ˆã‚Šæ­£å¸¸è¡¨ç¤ºã•ã‚Œã‚‹

## ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ: æ–°è¦è¿½åŠ ã—ãŸã‚«ãƒ†ã‚´ãƒªãƒ¼ãŒè¡¨ç¤ºã•ã‚Œãªã„
**åŸå› **: ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ãŒå¤ã„
**è§£æ±º**: `npm run generate:category-mapping` ã‚’å®Ÿè¡Œã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤

### å•é¡Œ: DBéšœå®³ã§ã‚µã‚¤ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„  
**åŸå› **: ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½ã®ä¸å…·åˆ
**è§£æ±º**: `lib/category-mapping.ts` ã®å­˜åœ¨ã¨å†…å®¹ã‚’ç¢ºèª

### å•é¡Œ: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ›´æ–°ã•ã‚Œãªã„
**åŸå› **: Supabaseæ¥ç¶šå•é¡Œ
**è§£æ±º**: ç’°å¢ƒå¤‰æ•° `NEXT_PUBLIC_SUPABASE_URL`, `SUPABASE_SERVICE_ROLE_KEY` ã‚’ç¢ºèª

## ğŸ”„ ç¶™ç¶šçš„æ”¹å–„

### æœˆæ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼
1. DBçµ±è¨ˆã®ç¢ºèªï¼ˆã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒ»ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªãƒ¼ä»¶æ•°ï¼‰
2. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ã®ç¢ºèª
3. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç™ºå‹•é »åº¦ã®ç¢ºèª

### å°†æ¥çš„ãªå®Œå…¨DBåŒ–
ç¾åœ¨ã¯DBå„ªå…ˆ+ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ–¹å¼ã§ã™ãŒã€å°†æ¥çš„ã«ã¯ï¼š
1. DBå®‰å®šæ€§ã®ç¢ºèª
2. æ®µéšçš„ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‰Šé™¤
3. å®Œå…¨DBãƒ™ãƒ¼ã‚¹ã¸ã®ç§»è¡Œ

---
**æœ€çµ‚æ›´æ–°**: 2025-09-24  
**æ‹…å½“**: Claude Code AI Assistant  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼**: å®šæœŸçš„ã«ã“ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã®æœ‰åŠ¹æ€§ã‚’ç¢ºèªã—ã¦ãã ã•ã„